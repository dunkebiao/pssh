#!/usr/bin/env python
# coding=utf-8

__author__ = 'dunkebiao'

"install pssh file."

import sys
import getopt
import urllib2


class Install:
    install_dir = ''
    filename = ''
    pssh = ''

    def __init__(self, install_dir, filename):
        self.install_dir = install_dir
        self.filename = filename

    def get_pssh(self):
        """
            get pssh file
        :return:obj
        """
        try:
            self.pssh = urllib2.urlopen('https://raw.githubusercontent.com/dunkebiao/python/master/ssh.py').read()
        except urllib2.HTTPError, e:
            sys.exit(e.code)
        except urllib2.URLError, e:
            sys.exit(e.reason)
        return self

    def put_pssh(self):
        """
            write pssh file
        :return:obj
        """
        try:
            f = open(self.install_dir + '/' + self.filename, 'w+')
            f.writelines(self.pssh)
            f.close()
        except IOError, e:
            sys.exit(e)
        return self


def main():
    """
        this is mian
    """
    try:
        options, args = getopt.getopt(sys.argv[1:], "f:d:", ["filename=", "install-dir="])
    except getopt.GetoptError, e:
        sys.exit(e.msg)

    install_dir = '/usr/local/bin'
    filename = 'pssh'

    for name, value in options:
        if name in ("-d", "--install_dir"):
            install_dir = value.rsplit('/')
        if name in ("-f", "--filename"):
            filename = value

    Install(install_dir, filename)


if __name__ == '__main__':
    main()
